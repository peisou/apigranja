$(window).on("load",function(){function t(){clearTimeout(b),"grouped"===this.value?n():r()}function n(){y.domain([0,s]),B.transition().duration(500).delay(function(t,n){return 10*n}).attr("x",function(t,n,r){return h(t.x)+h.rangeBand()/c*r}).attr("width",h.rangeBand()/c).transition().attr("y",function(t){return y(t.y)}).attr("height",function(t){return u-y(t.y)})}function r(){y.domain([0,g]),B.transition().duration(500).delay(function(t,n){return 10*n}).attr("y",function(t){return y(t.y0+t.y)}).attr("height",function(t){return y(t.y0)-y(t.y0+t.y)}).transition().attr("x",function(t){return h(t.x)}).attr("width",h.rangeBand())}function a(t,n){var r,a=[];for(r=0;r<t;++r)a[r]=n+n*Math.random();for(r=0;r<5;++r)!function(n){for(var r=1/(.1+Math.random()),a=2*Math.random()-.5,e=10/(.1+Math.random()),i=0;i<t;i++){var o=(i/t-a)*e;n[i]+=r*Math.exp(-o*o)}}(a);return a.map(function(t,n){return{x:n,y:Math.max(0,t)}})}function e(){d=i.node().getBoundingClientRect().width-o.left-o.right,x.attr("width",d+o.left+o.right),w.attr("width",d+o.left+o.right),h.rangeRoundBands([0,d],.08),w.selectAll(".d3-xaxis").call(p),w.selectAll(".d3-bar").attr("x",function(t){return h(t.x)})}var i=d3.select("#stacked-to-grouped"),o={top:20,right:20,bottom:30,left:50},d=i.node().getBoundingClientRect().width-o.left-o.right,u=500-o.top-o.bottom,c=4,l=d3.layout.stack(),f=l(d3.range(c).map(function(){return a(58,.1)})),s=d3.max(f,function(t){return d3.max(t,function(t){return t.y})}),g=d3.max(f,function(t){return d3.max(t,function(t){return t.y0+t.y})}),h=d3.scale.ordinal().domain(d3.range(58)).rangeRoundBands([0,d],.08),y=d3.scale.linear().domain([0,g]).range([u,0]),m=d3.scale.linear().domain([0,c-1]).range(["#FECEA8","#E84A5F"]),p=d3.svg.axis().scale(h).tickSize(0).tickPadding(6).orient("bottom"),x=i.append("svg"),w=x.attr("width",d+o.left+o.right).attr("height",u+o.top+o.bottom).append("g").attr("transform","translate("+o.left+","+o.top+")"),v=w.selectAll(".layer").data(f).enter().append("g").attr("class","layer").style("fill",function(t,n){return m(n)}),B=v.selectAll(".d3-bar").data(function(t){return t}).enter().append("rect").attr("class","d3-bar").attr("x",function(t){return h(t.x)}).attr("y",u).attr("width",h.rangeBand()).attr("height",0);B.transition().delay(function(t,n){return 10*n}).attr("y",function(t){return y(t.y0+t.y)}).attr("height",function(t){return y(t.y0)-y(t.y0+t.y)}),w.append("g").attr("class","d3-axis d3-xaxis").attr("transform","translate(0,"+u+")").call(p),d3.selectAll("input").on("change",t);var b=setTimeout(function(){d3.select('input[value="grouped"]').property("checked",!0).each(t)},2e3);$(window).on("resize",e),$(".menu-toggle").on("click",e)});