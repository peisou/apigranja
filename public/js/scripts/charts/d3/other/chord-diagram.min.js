$(window).on("load",function(){function t(t,n){var e=(t.endAngle-t.startAngle)/t.value;return d3.range(0,t.value,n).map(function(n){return{value:n,angle:n*e+t.startAngle}})}var n=d3.select("#chord-diagram"),e=d3.formatPrefix(",.0",1e3),r=[[11975,5871,8916,2868],[1951,10048,2060,6171],[8010,16145,8090,8045],[1013,990,940,6907]],a=d3.scale.ordinal().domain(d3.range(4)).range(["#99B898","#FECEA8","#FF847C","#E84A5F"]),d=n.append("svg"),l=d,u=.5*Math.min(600,600)-40,o=u-30,i=d3.chord().padAngle(.05).sortSubgroups(d3.descending),s=d3.svg.arc().innerRadius(o).outerRadius(u),c=d3.ribbon().radius(o),g=l.append("g").attr("transform","translate(300,300)").datum(i(r)),p=g.append("g").attr("class","groups").selectAll("g").data(function(t){return t.groups}).enter().append("g");p.append("path").style("fill",function(t){return a(t.index)}).style("stroke",function(t){return d3.rgb(a(t.index)).darker()}).attr("d",s);var f=p.selectAll(".group-tick").data(function(n){return t(n,1e3)}).enter().append("g").attr("class","group-tick").attr("transform",function(t){return"rotate("+(180*t.angle/Math.PI-90)+") translate("+u+",0)"});f.append("line").attr("x2",6),f.filter(function(t){return t.value%5e3==0}).append("text").attr("x",8).attr("dy",".35em").attr("transform",function(t){return t.angle>Math.PI?"rotate(180) translate(-16)":null}).style("text-anchor",function(t){return t.angle>Math.PI?"end":null}).text(function(t){return e(t.value)}),g.append("g").attr("class","ribbons").selectAll("path").data(function(t){return t}).enter().append("path").attr("d",c).style("fill",function(t){return a(t.target.index)}).style("stroke",function(t){return d3.rgb(a(t.target.index)).darker()})});